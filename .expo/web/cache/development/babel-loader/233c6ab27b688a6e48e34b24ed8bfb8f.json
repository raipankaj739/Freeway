{"ast":null,"code":"import { EventEmitter } from '@unimodules/core';\nimport { UnavailabilityError } from '@unimodules/core';\nimport { Platform } from 'react-native';\nimport MediaLibrary from './ExponentMediaLibrary';\nconst eventEmitter = new EventEmitter(MediaLibrary);\n\nfunction arrayize(item) {\n  if (Array.isArray(item)) {\n    return item;\n  }\n\n  return item ? [item] : [];\n}\n\nfunction getId(ref) {\n  if (typeof ref === 'string') {\n    return ref;\n  }\n\n  return ref ? ref.id : undefined;\n}\n\nfunction checkAssetIds(assetIds) {\n  if (assetIds.some(id => !id || typeof id !== 'string')) {\n    throw new Error('Asset ID must be a string!');\n  }\n}\n\nfunction checkAlbumIds(albumIds) {\n  if (albumIds.some(id => !id || typeof id !== 'string')) {\n    throw new Error('Album ID must be a string!');\n  }\n}\n\nfunction checkMediaType(mediaType) {\n  if (Object.values(MediaType).indexOf(mediaType) === -1) {\n    throw new Error(`Invalid mediaType: ${mediaType}`);\n  }\n}\n\nfunction checkSortBy(sortBy) {\n  if (Array.isArray(sortBy)) {\n    checkSortByKey(sortBy[0]);\n\n    if (typeof sortBy[1] !== 'boolean') {\n      throw new Error('Invalid sortBy array argument. Second item must be a boolean!');\n    }\n  } else {\n    checkSortByKey(sortBy);\n  }\n}\n\nfunction checkSortByKey(sortBy) {\n  if (Object.values(SortBy).indexOf(sortBy) === -1) {\n    throw new Error(`Invalid sortBy key: ${sortBy}`);\n  }\n} // export constants\n\n\nexport const MediaType = MediaLibrary.MediaType;\nexport const SortBy = MediaLibrary.SortBy;\nexport async function createAssetAsync(localUri) {\n  if (!MediaLibrary.createAssetAsync) {\n    throw new UnavailabilityError('MediaLibrary', 'createAssetAsync');\n  }\n\n  if (!localUri || typeof localUri !== 'string') {\n    throw new Error('Invalid argument \"localUri\". It must be a string!');\n  }\n\n  const asset = await MediaLibrary.createAssetAsync(localUri);\n\n  if (Array.isArray(asset)) {\n    // Android returns an array with asset, we need to pick the first item\n    return asset[0];\n  }\n\n  return asset;\n}\nexport async function addAssetsToAlbumAsync(assets, album, copy = true) {\n  if (!MediaLibrary.addAssetsToAlbumAsync) {\n    throw new UnavailabilityError('MediaLibrary', 'addAssetsToAlbumAsync');\n  }\n\n  const assetIds = arrayize(assets).map(getId);\n  const albumId = getId(album);\n  checkAssetIds(assetIds);\n\n  if (!albumId || typeof albumId !== 'string') {\n    throw new Error('Invalid album ID. It must be a string!');\n  }\n\n  if (Platform.OS === 'ios') {\n    return await MediaLibrary.addAssetsToAlbumAsync(assetIds, albumId);\n  }\n\n  return await MediaLibrary.addAssetsToAlbumAsync(assetIds, albumId, !!copy);\n}\nexport async function removeAssetsFromAlbumAsync(assets, album) {\n  if (!MediaLibrary.removeAssetsFromAlbumAsync) {\n    throw new UnavailabilityError('MediaLibrary', 'removeAssetsFromAlbumAsync');\n  }\n\n  const assetIds = arrayize(assets).map(getId);\n  const albumId = getId(album);\n  checkAssetIds(assetIds);\n  return await MediaLibrary.removeAssetsFromAlbumAsync(assetIds, albumId);\n}\nexport async function deleteAssetsAsync(assets) {\n  if (!MediaLibrary.deleteAssetsAsync) {\n    throw new UnavailabilityError('MediaLibrary', 'deleteAssetsAsync');\n  }\n\n  const assetIds = arrayize(assets).map(getId);\n  checkAssetIds(assetIds);\n  return await MediaLibrary.deleteAssetsAsync(assetIds);\n}\nexport async function getAssetInfoAsync(asset) {\n  if (!MediaLibrary.getAssetInfoAsync) {\n    throw new UnavailabilityError('MediaLibrary', 'getAssetInfoAsync');\n  }\n\n  const assetId = getId(asset);\n  checkAssetIds([assetId]);\n  const assetInfo = await MediaLibrary.getAssetInfoAsync(assetId);\n\n  if (Array.isArray(assetInfo)) {\n    // Android returns an array with asset info, we need to pick the first item\n    return assetInfo[0];\n  }\n\n  return assetInfo;\n}\nexport async function getAlbumsAsync({\n  includeSmartAlbums = false\n} = {}) {\n  if (!MediaLibrary.getAlbumsAsync) {\n    throw new UnavailabilityError('MediaLibrary', 'getAlbumsAsync');\n  }\n\n  return await MediaLibrary.getAlbumsAsync({\n    includeSmartAlbums\n  });\n}\nexport async function getAlbumAsync(title) {\n  if (!MediaLibrary.getAlbumAsync) {\n    throw new UnavailabilityError('MediaLibrary', 'getAlbumAsync');\n  }\n\n  if (typeof title !== 'string') {\n    throw new Error('Album title must be a string!');\n  }\n\n  return await MediaLibrary.getAlbumAsync(title);\n}\nexport async function createAlbumAsync(albumName, asset, copyAsset = true) {\n  if (!MediaLibrary.createAlbumAsync) {\n    throw new UnavailabilityError('MediaLibrary', 'createAlbumAsync');\n  }\n\n  const assetId = getId(asset);\n\n  if (Platform.OS === 'android' && (typeof assetId !== 'string' || assetId.length === 0)) {\n    // it's not possible to create empty album on Android, so initial asset must be provided\n    throw new Error('MediaLibrary.createAlbumAsync must be called with an asset on Android.');\n  }\n\n  if (!albumName || typeof albumName !== 'string') {\n    throw new Error('Invalid argument \"albumName\". It must be a string!');\n  }\n\n  if (assetId != null && typeof assetId !== 'string') {\n    throw new Error('Asset ID must be a string!');\n  }\n\n  if (Platform.OS === 'ios') {\n    return await MediaLibrary.createAlbumAsync(albumName, assetId);\n  }\n\n  return await MediaLibrary.createAlbumAsync(albumName, assetId, !!copyAsset);\n}\nexport async function deleteAlbumsAsync(albums, assetRemove = false) {\n  if (!MediaLibrary.deleteAlbumsAsync) {\n    throw new UnavailabilityError('MediaLibrary', 'deleteAlbumsAsync');\n  }\n\n  const albumIds = arrayize(albums).map(getId);\n  checkAlbumIds(albumIds);\n\n  if (Platform.OS === 'android') {\n    return await MediaLibrary.deleteAlbumsAsync(albumIds);\n  }\n\n  return await MediaLibrary.deleteAlbumsAsync(albumIds, !!assetRemove);\n}\nexport async function getAssetsAsync(assetsOptions = {}) {\n  if (!MediaLibrary.getAssetsAsync) {\n    throw new UnavailabilityError('MediaLibrary', 'getAssetsAsync');\n  }\n\n  const {\n    first,\n    after,\n    album,\n    sortBy,\n    mediaType\n  } = assetsOptions;\n  const options = {\n    first: first == null ? 20 : first,\n    after: getId(after),\n    album: getId(album),\n    sortBy: arrayize(sortBy),\n    mediaType: arrayize(mediaType || [MediaType.photo])\n  };\n\n  if (first != null && typeof options.first !== 'number') {\n    throw new Error('Option \"first\" must be a number!');\n  }\n\n  if (after != null && typeof options.after !== 'string') {\n    throw new Error('Option \"after\" must be a string!');\n  }\n\n  if (album != null && typeof options.album !== 'string') {\n    throw new Error('Option \"album\" must be a string!');\n  }\n\n  options.sortBy.forEach(checkSortBy);\n  options.mediaType.forEach(checkMediaType);\n  return await MediaLibrary.getAssetsAsync(options);\n}\nexport function addListener(listener) {\n  const subscription = eventEmitter.addListener(MediaLibrary.CHANGE_LISTENER_NAME, listener);\n  return subscription;\n}\nexport function removeSubscription(subscription) {\n  subscription.remove();\n}\nexport function removeAllListeners() {\n  eventEmitter.removeAllListeners(MediaLibrary.CHANGE_LISTENER_NAME);\n} // iOS only\n\nexport async function getMomentsAsync() {\n  if (!MediaLibrary.getMomentsAsync) {\n    throw new UnavailabilityError('MediaLibrary', 'getMomentsAsync');\n  }\n\n  return await MediaLibrary.getMomentsAsync();\n}","map":{"version":3,"sources":["../src/MediaLibrary.ts"],"names":[],"mappings":"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","sourcesContent":["import { EventEmitter, Subscription } from '@unimodules/core';\nimport { UnavailabilityError } from '@unimodules/core';\nimport { Platform } from 'react-native';\n\nimport MediaLibrary from './ExponentMediaLibrary';\n\nconst eventEmitter = new EventEmitter(MediaLibrary);\n\nexport type MediaTypeValue = 'audio' | 'photo' | 'video' | 'unknown';\nexport type SortByKey =\n  | 'default'\n  | 'mediaType'\n  | 'width'\n  | 'height'\n  | 'creationTime'\n  | 'modificationTime'\n  | 'duration';\nexport type SortByValue = [SortByKey, boolean] | SortByKey;\n\nexport type MediaTypeObject = {\n  audio: 'audio';\n  photo: 'photo';\n  video: 'video';\n  unknown: 'unknown';\n};\n\nexport type SortByObject = {\n  default: 'default';\n  mediaType: 'mediaType';\n  width: 'width';\n  height: 'height';\n  creationTime: 'creationTime';\n  modificationTime: 'modificationTime';\n  duration: 'duration';\n};\n\nexport type Asset = {\n  id: string;\n  filename: string;\n  uri: string;\n  mediaType: MediaTypeValue;\n  mediaSubtypes?: Array<string>; // iOS only\n  width: number;\n  height: number;\n  creationTime: number;\n  modificationTime: number;\n  duration: number;\n  albumId?: string; // Android only\n};\n\nexport type AssetInfo = Asset & {\n  localUri?: string;\n  location?: Location;\n  exif?: Object;\n  isFavorite?: boolean; //iOS only\n};\n\nexport type Location = {\n  latitude: number;\n  longitude: number;\n};\n\nexport type Album = {\n  id: string;\n  title: string;\n  assetCount: number;\n  type?: string; // iOS only\n\n  // iOS moments only\n  startTime: number;\n  endTime: number;\n  approximateLocation?: Location;\n  locationNames?: Array<string>;\n};\n\nexport type AlbumsOptions = {\n  // iOS only\n  includeSmartAlbums?: boolean;\n};\n\nexport type AssetsOptions = {\n  first?: number;\n  after?: AssetRef;\n  album?: AlbumRef;\n  sortBy?: Array<SortByValue> | SortByValue;\n  mediaType?: Array<MediaTypeValue> | MediaTypeValue;\n};\n\nexport type PagedInfo<T> = {\n  assets: Array<T>;\n  endCursor: string;\n  hasNextPage: boolean;\n  totalCount: number;\n};\n\nexport type AssetRef = Asset | string;\nexport type AlbumRef = Album | string;\n\nfunction arrayize(item: any): Array<any> {\n  if (Array.isArray(item)) {\n    return item;\n  }\n  return item ? [item] : [];\n}\n\nfunction getId(ref: any): string | undefined {\n  if (typeof ref === 'string') {\n    return ref;\n  }\n  return ref ? ref.id : undefined;\n}\n\nfunction checkAssetIds(assetIds: any): void {\n  if (assetIds.some(id => !id || typeof id !== 'string')) {\n    throw new Error('Asset ID must be a string!');\n  }\n}\n\nfunction checkAlbumIds(albumIds: any): void {\n  if (albumIds.some(id => !id || typeof id !== 'string')) {\n    throw new Error('Album ID must be a string!');\n  }\n}\n\nfunction checkMediaType(mediaType: any): void {\n  if (Object.values(MediaType).indexOf(mediaType) === -1) {\n    throw new Error(`Invalid mediaType: ${mediaType}`);\n  }\n}\n\nfunction checkSortBy(sortBy: any): void {\n  if (Array.isArray(sortBy)) {\n    checkSortByKey(sortBy[0]);\n\n    if (typeof sortBy[1] !== 'boolean') {\n      throw new Error('Invalid sortBy array argument. Second item must be a boolean!');\n    }\n  } else {\n    checkSortByKey(sortBy);\n  }\n}\n\nfunction checkSortByKey(sortBy: any): void {\n  if (Object.values(SortBy).indexOf(sortBy) === -1) {\n    throw new Error(`Invalid sortBy key: ${sortBy}`);\n  }\n}\n\n// export constants\nexport const MediaType: MediaTypeObject = MediaLibrary.MediaType;\nexport const SortBy: SortByObject = MediaLibrary.SortBy;\n\nexport async function createAssetAsync(localUri: string): Promise<Asset> {\n  if (!MediaLibrary.createAssetAsync) {\n    throw new UnavailabilityError('MediaLibrary', 'createAssetAsync');\n  }\n\n  if (!localUri || typeof localUri !== 'string') {\n    throw new Error('Invalid argument \"localUri\". It must be a string!');\n  }\n  const asset = await MediaLibrary.createAssetAsync(localUri);\n\n  if (Array.isArray(asset)) {\n    // Android returns an array with asset, we need to pick the first item\n    return asset[0];\n  }\n  return asset;\n}\n\nexport async function addAssetsToAlbumAsync(\n  assets: Array<AssetRef> | AssetRef,\n  album: AlbumRef,\n  copy: boolean = true\n) {\n  if (!MediaLibrary.addAssetsToAlbumAsync) {\n    throw new UnavailabilityError('MediaLibrary', 'addAssetsToAlbumAsync');\n  }\n\n  const assetIds = arrayize(assets).map(getId);\n  const albumId = getId(album);\n\n  checkAssetIds(assetIds);\n\n  if (!albumId || typeof albumId !== 'string') {\n    throw new Error('Invalid album ID. It must be a string!');\n  }\n\n  if (Platform.OS === 'ios') {\n    return await MediaLibrary.addAssetsToAlbumAsync(assetIds, albumId);\n  }\n  return await MediaLibrary.addAssetsToAlbumAsync(assetIds, albumId, !!copy);\n}\n\nexport async function removeAssetsFromAlbumAsync(\n  assets: Array<AssetRef> | AssetRef,\n  album: AlbumRef\n) {\n  if (!MediaLibrary.removeAssetsFromAlbumAsync) {\n    throw new UnavailabilityError('MediaLibrary', 'removeAssetsFromAlbumAsync');\n  }\n\n  const assetIds = arrayize(assets).map(getId);\n  const albumId = getId(album);\n\n  checkAssetIds(assetIds);\n  return await MediaLibrary.removeAssetsFromAlbumAsync(assetIds, albumId);\n}\n\nexport async function deleteAssetsAsync(assets: Array<AssetRef> | AssetRef) {\n  if (!MediaLibrary.deleteAssetsAsync) {\n    throw new UnavailabilityError('MediaLibrary', 'deleteAssetsAsync');\n  }\n\n  const assetIds = arrayize(assets).map(getId);\n\n  checkAssetIds(assetIds);\n  return await MediaLibrary.deleteAssetsAsync(assetIds);\n}\n\nexport async function getAssetInfoAsync(asset: AssetRef): Promise<AssetInfo> {\n  if (!MediaLibrary.getAssetInfoAsync) {\n    throw new UnavailabilityError('MediaLibrary', 'getAssetInfoAsync');\n  }\n\n  const assetId = getId(asset);\n\n  checkAssetIds([assetId]);\n\n  const assetInfo = await MediaLibrary.getAssetInfoAsync(assetId);\n\n  if (Array.isArray(assetInfo)) {\n    // Android returns an array with asset info, we need to pick the first item\n    return assetInfo[0];\n  }\n  return assetInfo;\n}\n\nexport async function getAlbumsAsync({ includeSmartAlbums = false }: AlbumsOptions = {}): Promise<\n  Array<Album>\n> {\n  if (!MediaLibrary.getAlbumsAsync) {\n    throw new UnavailabilityError('MediaLibrary', 'getAlbumsAsync');\n  }\n  return await MediaLibrary.getAlbumsAsync({ includeSmartAlbums });\n}\n\nexport async function getAlbumAsync(title: string): Promise<Album> {\n  if (!MediaLibrary.getAlbumAsync) {\n    throw new UnavailabilityError('MediaLibrary', 'getAlbumAsync');\n  }\n  if (typeof title !== 'string') {\n    throw new Error('Album title must be a string!');\n  }\n  return await MediaLibrary.getAlbumAsync(title);\n}\n\nexport async function createAlbumAsync(\n  albumName: string,\n  asset?: AssetRef,\n  copyAsset: boolean = true\n): Promise<Album> {\n  if (!MediaLibrary.createAlbumAsync) {\n    throw new UnavailabilityError('MediaLibrary', 'createAlbumAsync');\n  }\n\n  const assetId = getId(asset);\n\n  if (Platform.OS === 'android' && (typeof assetId !== 'string' || assetId.length === 0)) {\n    // it's not possible to create empty album on Android, so initial asset must be provided\n    throw new Error('MediaLibrary.createAlbumAsync must be called with an asset on Android.');\n  }\n  if (!albumName || typeof albumName !== 'string') {\n    throw new Error('Invalid argument \"albumName\". It must be a string!');\n  }\n  if (assetId != null && typeof assetId !== 'string') {\n    throw new Error('Asset ID must be a string!');\n  }\n\n  if (Platform.OS === 'ios') {\n    return await MediaLibrary.createAlbumAsync(albumName, assetId);\n  }\n  return await MediaLibrary.createAlbumAsync(albumName, assetId, !!copyAsset);\n}\n\nexport async function deleteAlbumsAsync(\n  albums: Array<AlbumRef> | AlbumRef,\n  assetRemove: boolean = false\n) {\n  if (!MediaLibrary.deleteAlbumsAsync) {\n    throw new UnavailabilityError('MediaLibrary', 'deleteAlbumsAsync');\n  }\n\n  const albumIds = arrayize(albums).map(getId);\n\n  checkAlbumIds(albumIds);\n  if (Platform.OS === 'android') {\n    return await MediaLibrary.deleteAlbumsAsync(albumIds);\n  }\n  return await MediaLibrary.deleteAlbumsAsync(albumIds, !!assetRemove);\n}\n\nexport async function getAssetsAsync(assetsOptions: AssetsOptions = {}): Promise<PagedInfo<Asset>> {\n  if (!MediaLibrary.getAssetsAsync) {\n    throw new UnavailabilityError('MediaLibrary', 'getAssetsAsync');\n  }\n\n  const { first, after, album, sortBy, mediaType } = assetsOptions;\n\n  const options = {\n    first: first == null ? 20 : first,\n    after: getId(after),\n    album: getId(album),\n    sortBy: arrayize(sortBy),\n    mediaType: arrayize(mediaType || [MediaType.photo]),\n  };\n\n  if (first != null && typeof options.first !== 'number') {\n    throw new Error('Option \"first\" must be a number!');\n  }\n  if (after != null && typeof options.after !== 'string') {\n    throw new Error('Option \"after\" must be a string!');\n  }\n  if (album != null && typeof options.album !== 'string') {\n    throw new Error('Option \"album\" must be a string!');\n  }\n\n  options.sortBy.forEach(checkSortBy);\n  options.mediaType.forEach(checkMediaType);\n\n  return await MediaLibrary.getAssetsAsync(options);\n}\n\nexport function addListener(listener: () => void): Subscription {\n  const subscription = eventEmitter.addListener(MediaLibrary.CHANGE_LISTENER_NAME, listener);\n  return subscription;\n}\n\nexport function removeSubscription(subscription: Subscription): void {\n  subscription.remove();\n}\n\nexport function removeAllListeners(): void {\n  eventEmitter.removeAllListeners(MediaLibrary.CHANGE_LISTENER_NAME);\n}\n\n// iOS only\nexport async function getMomentsAsync() {\n  if (!MediaLibrary.getMomentsAsync) {\n    throw new UnavailabilityError('MediaLibrary', 'getMomentsAsync');\n  }\n\n  return await MediaLibrary.getMomentsAsync();\n}\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}